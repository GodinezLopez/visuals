local a=game:GetService("Players")local b=a.LocalPlayer;local c=game:GetService("RunService")local d=game:GetService("Workspace")local e=game:GetService("Lighting")local f={ShowSilhouettes=false,ShowDistance=false,ShowLines=false,Fullbright=false,Xray=false,ShowFriends=false}local g={Highlights={},Distances={},Lines={},Friends={},PlayerAddedConnection=nil,CharacterAddedConnections={},RenderSteppedConnections={},OriginalLightingSettings={Brightness=e.Brightness,ClockTime=e.ClockTime,FogEnd=e.FogEnd,GlobalShadows=e.GlobalShadows,OutdoorAmbient=e.OutdoorAmbient}}local function h(i)if i.Team then local j=i.TeamColor.Color;local k=(j.R+j.G+j.B)/3;if k<0.3 then return Color3.new(j.R+0.3,j.G+0.3,j.B+0.3)elseif k>0.7 then return Color3.new(j.R-0.3,j.G-0.3,j.B-0.3)end;return j end;return Color3.new(1,0,0)end;local function l(m)if m and m.Parent then m:Destroy()return true end;return false end;local function checkAndUpdate()if f.ShowSilhouettes or f.ShowDistance or f.ShowLines or f.ShowFriends then for _,player in pairs(a:GetPlayers())do if player~=b then if f.ShowSilhouettes then y(player)end;if f.ShowDistance then C(player)end;if f.ShowLines then G(player)end;if f.ShowFriends then L(player)end end end end end;c:BindToRenderStep("UpdateESP",Enum.RenderPriority.Camera.Value,checkAndUpdate)local function n()for o,i in pairs(a:GetPlayers())do if g.Highlights[i]then l(g.Highlights[i])g.Highlights[i]=nil end end;g.Highlights={}end;local function p()for o,i in pairs(a:GetPlayers())do if g.Distances[i]then if g.Distances[i].Billboard then l(g.Distances[i].Billboard)end;g.Distances[i]=nil end end;g.Distances={}end;local function q()for o,i in pairs(a:GetPlayers())do if g.Lines[i]then l(g.Lines[i].Attachment0)l(g.Lines[i].Attachment1)l(g.Lines[i].Beam)g.Lines[i]=nil end end;g.Lines={}end;local function r()for o,i in pairs(a:GetPlayers())do if g.Friends[i]then l(g.Friends[i].NameLabel)g.Friends[i]=nil end end;g.Friends={}end;local function s()for o,t in pairs(g.RenderSteppedConnections)do if t then t:Disconnect()end end;g.RenderSteppedConnections={}for o,t in pairs(g.CharacterAddedConnections)do if t then t:Disconnect()end end;g.CharacterAddedConnections={}if g.PlayerAddedConnection then g.PlayerAddedConnection:Disconnect()g.PlayerAddedConnection=nil end end;local function u()n()p()q()r()s()if f.Fullbright then for v,w in pairs(g.OriginalLightingSettings)do e[v]=w end;f.Fullbright=false end;if f.Xray then for o,x in pairs(d:GetDescendants())do if x:IsA("BasePart")then x.LocalTransparencyModifier=0 end end;f.Xray=false end end local function y(i)if i==b then return end;local function z(A)if g.Highlights[i]then l(g.Highlights[i])end;if A then local B=Instance.new("Highlight")B.FillColor=h(i)B.FillTransparency=0.5;B.OutlineColor=h(i)B.OutlineTransparency=0;B.Parent=A;g.Highlights[i]=B end end;if i.Character then z(i.Character)end;i.CharacterAdded:Connect(function(A)if f.ShowSilhouettes then z(A)end end)i.CharacterRemoving:Connect(function()if g.Highlights[i]then l(g.Highlights[i])g.Highlights[i]=nil end end)end;local function C(i)if i==b then return end;local function D(A)if g.Distances[i]then l(g.Distances[i].Billboard)end;if A then local E=Instance.new("BillboardGui")E.Size=UDim2.new(0,200,0,50)E.StudsOffset=Vector3.new(0,2,0)E.AlwaysOnTop=true;local F=Instance.new("TextLabel")F.Size=UDim2.new(1,0,1,0)F.BackgroundTransparency=1;F.TextColor3=h(i)F.TextStrokeTransparency=0;F.TextSize=14;F.Font=Enum.Font.GothamBold;F.Parent=E;if A:FindFirstChild("Head")then E.Parent=A.Head;g.Distances[i]={Billboard=E,Label=F}end end end;if i.Character then D(i.Character)end;i.CharacterAdded:Connect(function(A)if f.ShowDistance then D(A)end end)i.CharacterRemoving:Connect(function()if g.Distances[i]then l(g.Distances[i].Billboard)g.Distances[i]=nil end end)end;local function G(i)if i==b then return end;local function H(A)if g.Lines[i]then l(g.Lines[i].Attachment0)l(g.Lines[i].Attachment1)l(g.Lines[i].Beam)end;if A and A:FindFirstChild("HumanoidRootPart")and b.Character and b.Character:FindFirstChild("HumanoidRootPart")then local I=Instance.new("Attachment")local J=Instance.new("Attachment")local K=Instance.new("Beam")I.Parent=b.Character.HumanoidRootPart;J.Parent=A.HumanoidRootPart;K.Attachment0=I;K.Attachment1=J;K.Width0=0.2;K.Width1=0.2;K.FaceCamera=true;K.Color=ColorSequence.new(h(i))K.Parent=d.Terrain;g.Lines[i]={Attachment0=I,Attachment1=J,Beam=K}end end;if i.Character then H(i.Character)end;i.CharacterAdded:Connect(function(A)if f.ShowLines then H(A)end end)i.CharacterRemoving:Connect(function()if g.Lines[i]then l(g.Lines[i].Attachment0)l(g.Lines[i].Attachment1)l(g.Lines[i].Beam)g.Lines[i]=nil end end)end;local function L(i)if i==b then return end;if not i:IsFriendsWith(b.UserId)then return end;local function M(A)if g.Friends[i]then l(g.Friends[i].NameLabel)end;if A then local N=Instance.new("BillboardGui")N.Size=UDim2.new(0,200,0,50)N.StudsOffset=Vector3.new(0,4,0)N.AlwaysOnTop=true;local O=Instance.new("TextLabel")O.Size=UDim2.new(1,0,1,0)O.BackgroundTransparency=1;O.Text=i.Name;O.TextSize=16;O.Font=Enum.Font.Highway;O.Parent=N;c.RenderStepped:Connect(function()if f.ShowFriends then local P=(tick()%5)/5;O.TextColor3=Color3.fromHSV(P,1,1)end end)if A:FindFirstChild("Head")then N.Parent=A.Head;g.Friends[i]={NameLabel=N}end end end;if i.Character then M(i.Character)end;i.CharacterAdded:Connect(function(A)if f.ShowFriends then M(A)end end)i.CharacterRemoving:Connect(function()if g.Friends[i]then l(g.Friends[i].NameLabel)g.Friends[i]=nil end end)end;local function Q()if not b.Character or not b.Character:FindFirstChild("HumanoidRootPart")then return end;for i,R in pairs(g.Distances)do if i.Character and i.Character:FindFirstChild("HumanoidRootPart")then local S=(i.Character.HumanoidRootPart.Position-b.Character.HumanoidRootPart.Position).Magnitude;R.Label.Text=math.floor(S)end end end;local function T()f.Fullbright=not f.Fullbright;if f.Fullbright then g.RenderSteppedConnections.Fullbright=c.RenderStepped:Connect(function()e.Brightness=2;e.ClockTime=14;e.FogEnd=100000;e.GlobalShadows=false;e.OutdoorAmbient=Color3.fromRGB(128,128,128)end)else if g.RenderSteppedConnections.Fullbright then g.RenderSteppedConnections.Fullbright:Disconnect()g.RenderSteppedConnections.Fullbright=nil end;for v,w in pairs(g.OriginalLightingSettings)do e[v]=w end end end;local function U()f.Xray=not f.Xray;for o,x in pairs(d:GetDescendants())do if x:IsA("BasePart")and not x:IsDescendantOf(b.Character)then x.LocalTransparencyModifier=f.Xray and 0.8 or 0 end end end;local function V()f.ShowSilhouettes=not f.ShowSilhouettes;if f.ShowSilhouettes then for o,i in pairs(a:GetPlayers())do if i~=b then y(i)end end else n()end end;local function W()f.ShowDistance=not f.ShowDistance;if f.ShowDistance then for o,i in pairs(a:GetPlayers())do if i~=b then C(i)end end;g.RenderSteppedConnections.Distance=c.RenderStepped:Connect(Q)else p()if g.RenderSteppedConnections.Distance then g.RenderSteppedConnections.Distance:Disconnect()g.RenderSteppedConnections.Distance=nil end end end;local function X()f.ShowLines=not f.ShowLines;if f.ShowLines then for o,i in pairs(a:GetPlayers())do if i~=b then G(i)end end else q()end end;local function Y()f.ShowFriends=not f.ShowFriends;if f.ShowFriends then for o,i in pairs(a:GetPlayers())do if i~=b then L(i)end end else r()end end
